<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nebula</title>

    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#6366f1">
    <meta name="color-scheme" content="dark">

    <link rel="apple-touch-icon" sizes="180x180" href="assets/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/x-icon" href="assets/favicons/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicons/favicon-16x16.png">
    <link rel="manifest" href="manifest.json">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@500;700;800&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="styles/layout.css">
    <style>
        .browse-grid-container {
            padding: 40px;
            width: 100%;
            overflow-y: auto;
            height: 100%;
        }

        .browse-header {
            margin-bottom: 30px;
        }

        .browse-title {
            font-family: 'Outfit', sans-serif;
            font-size: 2.5rem;
            color: white;
            margin-bottom: 8px;
        }

        .browse-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 24px;
        }

        .browse-card {
            background: #111;
            border: 1px solid #222;
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.2s;
            cursor: pointer;
        }

        .browse-card:hover {
            transform: translateY(-4px);
            border-color: #444;
        }

        .browse-thumb {
            width: 100%;
            aspect-ratio: 16/9;
            object-fit: cover;
            background: #000;
        }

        .browse-info {
            padding: 16px;
        }

        .browse-name {
            font-weight: 700;
            color: white;
        }

        .browse-meta {
            font-size: 0.85rem;
            color: #666;
        }
    </style>
</head>

<body>

    <div class="app-layout">

        <!-- SIDEBAR -->
        <aside class="sidebar">
            <div class="brand">
                <img src="assets/favicons/android-chrome-512x512.png" alt="Logo"
                    style="width: 24px; height: 24px; object-fit: contain;">
                Nebula
            </div>

            <nav class="nav-section">
                <!-- Wrapper for structure consistency -->
                <div class="nav-item-container">
                    <a href="#" class="nav-item active" id="nav-home">
                        <div class="nav-item-left">
                            <i data-feather="home" class="nav-icon"></i>
                            <span>Home</span>
                        </div>
                    </a>
                </div>

                <div class="nav-item-container">
                    <a href="#" class="nav-item">
                        <div class="nav-item-left">
                            <i data-feather="trending-up" class="nav-icon"></i>
                            <span>Popular</span>
                        </div>
                    </a>
                </div>
            </nav>

            <div style="height: 1px; background: #1a1a1a; margin: 8px 0 16px 0;"></div>

            <nav class="nav-section">

                <!-- CATEGORIES -->
                <div class="nav-item-container">
                    <a href="#" class="nav-item" id="nav-categories-toggle">
                        <div class="nav-item-left">
                            <i data-feather="grid" class="nav-icon"></i>
                            <span>Categories</span>
                        </div>
                        <i data-feather="chevron-right" class="nav-arrow"></i>
                    </a>
                    <div id="submenu-categories" class="submenu">
                        <!-- Filled by JS -->
                    </div>
                </div>

                <!-- APPS -->
                <div class="nav-item-container">
                    <a href="#" class="nav-item" id="nav-apps-toggle">
                        <div class="nav-item-left">
                            <i data-feather="box" class="nav-icon"></i>
                            <span>Apps</span>
                        </div>
                        <i data-feather="chevron-right" class="nav-arrow"></i>
                    </a>
                    <div id="submenu-apps" class="submenu">
                        <!-- Filled by JS -->
                    </div>
                </div>

                <!-- GAMES -->
                <div class="nav-item-container">
                    <a href="#" class="nav-item" id="nav-games-toggle">
                        <div class="nav-item-left">
                            <i data-feather="play" class="nav-icon"></i>
                            <span>Games</span>
                        </div>
                        <i data-feather="chevron-right" class="nav-arrow"></i>
                    </a>
                    <div id="submenu-games" class="submenu">
                        <!-- Filled by JS -->
                    </div>
                </div>

            </nav>

            <div class="sidebar-footer">
                <div class="nav-item-container">
                    <a href="#" class="nav-item">
                        <div class="nav-item-left">
                            <i data-feather="shield" class="nav-icon"></i>
                            <span>Privacy Policy</span>
                        </div>
                    </a>
                </div>
            </div>
        </aside>

        <!-- TOP BAR -->
        <header class="top-bar">
            <div class="search-container">
                <i data-feather="search" class="search-icon"></i>
                <input type="text" class="search-input" placeholder="Search games...">
            </div>

            <div class="top-widgets">
                <div class="widget">
                    <div class="widget-label">
                        <i data-feather="monitor" style="width: 12px; height: 12px;"></i> FPS
                    </div>
                    <div class="widget-value">
                        <span id="fps-counter">60</span>
                    </div>
                </div>
                <!-- Last Update Widget -->
                <div class="widget">
                    <div class="widget-label">
                        <i data-feather="github" style="width: 12px; height: 12px;"></i> Last Update (CST)
                    </div>
                    <div class="widget-value">
                        <span id="last-update">Loading...</span>
                    </div>
                </div>
                <div class="widget">
                    <div class="widget-label">
                        <i data-feather="clock" style="width: 12px; height: 12px;"></i> Your Time
                    </div>
                    <div class="widget-value">
                        <span id="clock">--:--</span>
                    </div>
                </div>

                <button id="open-settings"
                    style="background: transparent; border: 1px solid #333; color: #666; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                    <i data-feather="settings" style="width: 14px"></i>
                </button>
            </div>
        </header>

        <!-- MAIN LAYOUT -->
        <main class="content-area" id="main-content">

            <div id="dashboard-view">
                <section class="hero-section">
                    <h1 class="main-title">Nebula</h1>
                    <p class="subtitle">Bypass restrictions and play 1000+ unblocked games. Smoother, faster, and always
                        accessible.</p>

                    <div class="actions-grid">
                        <div class="action-card primary-large"
                            onclick="document.getElementById('nav-games-toggle').click()">
                            <div class="action-icon">
                                <i data-feather="play-circle"></i>
                            </div>
                            <div class="action-info">
                                <div class="action-title">Start Playing</div>
                                <div class="action-desc">Browse all games</div>
                            </div>
                        </div>

                        <div class="action-card"
                            onclick="window.open('https://github.com/tracerip/nebula/tree/v2', '_blank')">
                            <div class="action-icon">
                                <i data-feather="github"></i>
                            </div>
                            <div class="action-info">
                                <div class="action-title">GitHub</div>
                                <div class="action-desc">Access our project.</div>
                            </div>
                        </div>

                        <div class="action-card" onclick="window.open('https://discord.gg/qtMAMfz7jY', '_blank')">
                            <div class="action-icon">
                                <i data-feather="message-square"></i>
                            </div>
                            <div class="action-info">
                                <div class="action-title">Discord</div>
                                <div class="action-desc">Join community</div>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="grid-panel">
                    <div class="tilted-grid">
                        <div class="scroll-track" id="visual-grid"></div>
                    </div>
                </section>
            </div>

        </main>
    </div>

    <!-- SETTINGS MODAL -->
    <div class="modal-overlay" id="settings-modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">Settings</span>
                <button class="modal-close" id="close-settings"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">

                <!-- Cloaking Section -->
                <div class="setting-group">
                    <label class="setting-label"><i data-feather="eye-off"
                            style="width:14px; margin-right:6px; display:inline-block;"></i> Tab Cloaking</label>
                    <div style="margin-bottom: 12px;">
                        <input type="text" id="set-title" class="setting-input" placeholder="Page Title (e.g. Google)">
                    </div>
                    <div>
                        <input type="text" id="set-icon" class="setting-input" placeholder="Icon URL">
                    </div>

                    <div class="preset-grid">
                        <div class="preset-card" data-preset="google">
                            <img src="https://www.google.com/favicon.ico" class="preset-icon">
                            <span class="preset-name">Google</span>
                        </div>
                        <div class="preset-card" data-preset="classroom">
                            <img src="https://www.gstatic.com/classroom/ic_product_classroom_144.png"
                                class="preset-icon">
                            <span class="preset-name">Classroom</span>
                        </div>
                        <div class="preset-card" data-preset="drive">
                            <img src="https://ssl.gstatic.com/images/branding/product/1x/drive_2020q4_32dp.png"
                                class="preset-icon">
                            <span class="preset-name">Drive</span>
                        </div>
                        <div class="preset-card" data-preset="gmail">
                            <img src="https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico" class="preset-icon">
                            <span class="preset-name">Gmail</span>
                        </div>
                    </div>
                </div>

                <!-- Panic Button Section -->
                <div class="setting-group">
                    <label class="setting-label"><i data-feather="alert-triangle"
                            style="width:14px; margin-right:6px; display:inline-block;"></i> Panic Button</label>
                    <div style="margin-bottom: 10px;">
                        <input type="text" id="set-panic-key" class="setting-input"
                            placeholder="Click to set Keybind..." readonly
                            style="cursor: pointer; text-align: center; border-color: #f87171; color: #f87171;">
                    </div>
                    <div style="margin-bottom: 10px;">
                        <select id="set-panic-action" class="setting-select">
                            <option value="redirect">Redirect Current Tab</option>
                            <option value="close">Close Tab (If possible)</option>
                            <!-- <option value="popup">Redirect & New Tab</option> -->
                        </select>
                    </div>
                    <div>
                        <input type="text" id="set-panic-url" class="setting-input"
                            placeholder="Panic URL (default: google.com)">
                    </div>
                    <p class="setting-helper">Set a key that instantly hides the site.</p>
                </div>

            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="scripts/renderGames.js"></script>
    <script src="scripts/fileSystem.js"></script>
    <script src="scripts/settings.js"></script>

    <script>
        feather.replace();
        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }
        setInterval(updateClock, 1000);
        updateClock();
        setInterval(() => {
            const fps = Math.floor(Math.random() * (62 - 58 + 1) + 58);
            document.getElementById('fps-counter').innerText = fps;
        }, 2000);

        // Fetch Last GitHub Commit
        async function fetchLastCommit() {
            try {
                const response = await fetch('https://api.github.com/repos/tracerip/nebula/commits?per_page=1');
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.json();
                const dateStr = data[0].commit.committer.date;

                // Format to CST/CDT
                const dateObj = new Date(dateStr);
                const formatter = new Intl.DateTimeFormat('en-US', {
                    timeZone: 'America/Chicago',
                    year: 'numeric',
                    month: 'numeric',
                    day: 'numeric',
                    hour: 'numeric',
                    minute: 'numeric'
                });

                document.getElementById('last-update').innerText = formatter.format(dateObj);
            } catch (error) {
                console.error('Failed to fetch commit:', error);
                document.getElementById('last-update').innerText = 'Offline';
            }
        }
        fetchLastCommit();
    </script>
</body>

</html>